<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>API Documentation for CourseMate</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <link href="css/custom.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

  </head>
  <body>

 <div class="container">

      <div class="page-header">
        <h1>CourseMate</h1>
        <p class="lead">Get to work, guys.</p>
      </div>

      <h2>URLs</h2>

      <h3>User</h3>
       <table class="table table-striped table-bordered table-responsive" id="user-table">
        <tr>
          <td><b>URL</b></td><td><b>Method</b></td><td><b>Description</b></td><!-- <td><b>Response</b></td> -->
        </tr>
      </table>

      <h3>School</h3>
      <table class="table table-striped table-bordered table-responsive" id="school-table">
        <tr>
          <td><b>URL</b></td><td><b>Method</b></td><td><b>Description</b></td><!-- <td><b>Response</b></td> -->
        </tr>

      </table>

      <h3>Scheduler</h3>
       <table class="table table-striped table-bordered table-responsive" id="scheduler-table">
        <tr>
          <td><b>URL</b></td><td><b>Method</b></td><td><b>Description</b></td><!-- <td><b>Response</b></td> -->
        </tr>
      </table>

      <h2>Object Structures</h2>

      <h3 id="user-structure">User</h3>
 <table class="table table-striped table-bordered table-responsive" id="user-table">
        <tr>
          <td><pre>
id: ...,
calendar-id: ...,
name: ...,
start-time: ...,
end-time: ...,
location: ...,
creator: ...,
description: ...
</pre></td>
          <td>
             <table class="table table-striped table-bordered table-responsive" id="scheduler-table">
        <tr>
          <td><b>Key</b></td><td><b>Description</b></td>
        </tr>
        <tr>
          <td>id</td><td>ID of the event in question</td>
        </tr>
        <tr>
          <td>calendar-id</td><td>ID of the calendar that contains this event</td>
        </tr>
                <tr>
          <td>name</td><td>name of the eventt in question</td>
        </tr>
          <tr>
          <td>start-time</td><td>a full timestamp of when the event will begin</td>
          </tr>
          <tr>
          <td>end-time</td><td>a full timestamp of when the event will end</td>
          </tr>
          <tr>
          <td>location</td><td>a text location, preferably an address</td>
          </tr>
          <tr>
          <td>creator</td><td>ID of whoever created this event</td>
          </tr>
          <tr>
          <td>description</td><td>description of the event</td>
          </tr>
      </table>
          </td>
        </tr>
      </table>


      <h3 id="course-structure">Course</h3>
      <table class="table table-striped table-bordered table-responsive" id="scheduler-table">
        <tr>
          <td><pre>
id: ...,
name: ...,
school-id: ...,
school-name: ...,
calendar-id: ...
</pre></td>
          <td>
             <table class="table table-striped table-bordered table-responsive" id="scheduler-table">
        <tr>
          <td><b>Key</b></td><td><b>Description</b></td>
        </tr>
        <tr>
          <td>id</td><td>ID of the course in question</td>
        </tr>
                <tr>
          <td>name</td><td>name of the course in question</td>
        </tr>
          <tr>
          <td>school-id</td><td>ID of the school that the course is taught at</td>
          </tr>
          <tr>
          <td>school-name</td><td>name of the school that the course is taught at</td>
          </tr>
          <tr>
          <td>calendar-id</td><td>ID of the course calendar</td>
          </tr>
      </table>
          </td>
        </tr>
      </table>

      <h3 id="school-structure">School</h3>
       <table class="table table-striped table-bordered table-responsive" id="scheduler-table">
        <tr>
          <td><pre>
id: ...,
name: ...,
email-domains: [ ... ],
calendar-id: ...,
admins: [ ... ]
</pre></td>
          <td>
             <table class="table table-striped table-bordered table-responsive" id="scheduler-table">
        <tr>
          <td><b>Key</b></td><td><b>Description</b></td>
        </tr>
        <tr>
          <td>id</td><td>ID of the school in question</td>
        </tr>
                <tr>
          <td>name</td><td>name of the school in question</td>
        </tr>
          <tr>
          <td>email-domains</td><td>list of the e-mail domain names that one must have to be considered part of this school</td>
          </tr>

          <tr>
          <td>calendar-id</td><td>ID of the course calendar</td>
          </tr>
          <tr>
          <td>admins</td><td>list of user id's with admin rights to this school.</td>
          </tr>
      </table>
          </td>
        </tr>
      </table>
      <h3 id="calendar-structure">Calendar</h3>
       <table class="table table-striped table-bordered table-responsive" id="scheduler-table">
        <tr>
          <td><pre>
  id: ...,
  events: [ ... ]
</pre></td>
          <td>
             <table class="table table-striped table-bordered table-responsive" id="scheduler-table">
        <tr>
          <td><b>Key</b></td><td><b>Description</b></td>
        </tr>
        <tr>
          <td>id</td><td>ID of the calendar in question</td>
        </tr>
                <tr>
          <td>events</td><td>list of event id's in this calendar</td>
        </tr>

      </table>
          </td>
        </tr>
      </table>
      <h3 id="event-structure">Event</h3>
 <table class="table table-striped table-bordered table-responsive" id="scheduler-table">
        <tr>
          <td><pre>
id: ...,
calendar-id: ...,
name: ...,
start-time: ...,
end-time: ...,
location: ...,
creator: ...,
description: ...
</pre></td>
          <td>
             <table class="table table-striped table-bordered table-responsive" id="scheduler-table">
        <tr>
          <td><b>Key</b></td><td><b>Description</b></td>
        </tr>
        <tr>
          <td>id</td><td>ID of the event in question</td>
        </tr>
        <tr>
          <td>calendar-id</td><td>ID of the calendar that contains this event</td>
        </tr>
                <tr>
          <td>name</td><td>name of the eventt in question</td>
        </tr>
          <tr>
          <td>start-time</td><td>a full timestamp of when the event will begin</td>
          </tr>
          <tr>
          <td>end-time</td><td>a full timestamp of when the event will end</td>
          </tr>
          <tr>
          <td>location</td><td>a text location, preferably an address</td>
          </tr>
          <tr>
          <td>creator</td><td>ID of whoever created this event</td>
          </tr>
          <tr>
          <td>description</td><td>description of the event</td>
          </tr>
      </table>
          </td>
        </tr>
      </table>
  </div>


  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="js/jquery-1.11.1.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <script>
      var COLOURS = ["259b24", "e91e63", "3f51b5", ];
      var MODELS = ["course", "school", "calendar", "event"];
      function Doc(url, method, desc, response) {
        this.url = url;
        this.method = method;
        this.description = desc;
        this.response = response;
      }

      function surroundHTML(matches, s, prefix, suffix) {
          var new_s = s;
          if (matches) {
          for (var j = 0; j < matches.length, arg = matches[j]; j++) {
            new_s = new_s.replace(arg, prefix + arg + suffix);
          } }
          return new_s;
      }

      function addStructureSectionLinks(s) {
        var model;
        var new_s = s;
        for (var i = 0; i < MODELS.length, model = MODELS[i]; i++) {
            var descModelRefs = new_s.match(new RegExp("(\{" + model + "\})", "g"));
            new_s = surroundHTML(descModelRefs, new_s, '<a href="#'  + model + '-structure">', '</a>')
          }
        return new_s;
      }
      function responseToList(responseList, ordered) {
        var html = "";
        typeof ordered == "undefined" || !ordered ? html += "<ul>" : html += "<ol>";
        for (code in responseList) {
            var desc = addStructureSectionLinks(responseList[code]);
            html += "<li>Status " + code + ": " + desc + "</li>";
        }
        typeof ordered == "undefined" || !ordered ? html += "</ul>" : html += "</ol>";
        return html;
      }

      function addDoc(docList, idString, prefix) {
        var doc;
        var html = "";
        for (var i = 0; i < docList.length, doc = docList[i]; i++) {
          var urlArgs = doc.url.match(/(\{[\da-z\-]*\})/g);
          var url = surroundHTML(urlArgs, doc.url, '<span style="color: #' + COLOURS[0] + ';">', '</span>');
          html += "<tr><td>" + (typeof prefix == "undefined" ? url : prefix + url) + "</td><td>" + doc.method.toUpperCase() + "</td><td>" + doc.description + "</td>" /*+ responseToList(doc.response) */ + 
          "</tr>";
        }
        $(idString).append(html);
      }

      userLoginDocs = [
        new Doc("", "get", "Get currently logged-in user info.", ""),
        new Doc("login", "post","", ""),
        new Doc("register", "post","", ""),
      ];

      userDocs = [
        new Doc("{id}/edit", "put","", ""),
      ];

      courseDocs = [
        new Doc("", "post","Create a new course, if the currently logged-in user has admin rights to the given school.",
          {
            200: "Request was successful. Returns the newly created {course}.",
            401: "The currently-logged in user does not have admin rights to the school."
          }), // example of one with request filled out
        new Doc("{id}", "get","Get a course s.t. the course has the given ID, if the currently logged-in user is enrolled in the school of the course.", ""),
        new Doc("{id}/enrol", "put","Add currently logged-in student to course with the given ID, if the currently logged-in user is enrolled in the school of the course and is a student.", ""),
        new Doc("{id}/update", "put","Update the information in the course with the given ID, if the currently logged-in user is an instructor for the course.", "")
      ];

      schoolDocs = [
        //new Doc("/", "post","Create a new school.", ""),
        new Doc("{id}", "get", "Get school with given ID", ""),
        new Doc("{id}/enrol", "put", "Enrol currently logged-in user in the school with given ID, only if the user is a student.", ""),
        new Doc("{id}/update", "put", "Update the information in the school with given ID, only if the currently logged-in user has admin rights.", ""),

      ];

      calendarDocs = [
        //new Doc("/", "post","Create a new calendar.", ""),
        new Doc("school/{school-id}/calendar/", "get", "Get the calendar object for the school with the given ID if the currently-logged in user is enrolled in the school.", ""),
        new Doc("school/{school-id}/calendar/add", "post", "Add a new event to the calendar for the school with the given ID if the currently-logged in user has admin rights.", ""),
        new Doc("school/{school-id}/calendar/{event-id}", "get", "Get the event given an event-id only if it belongs to the school calendar and the current user is enrolled in the school.", ""),
        new Doc("school/{school-id}/calendar/{event-id}/update", "put", "Update event with given event-id in the calendar for the school with the given ID if the currently-logged in user has admin rights.", ""),

        new Doc("course/{course-id}/calendar/" ,"get", "Get the calendar object of the course with course-id, only if the currently logged-in user is enrolled in the course or is an instructor for the course." ,""),
        new Doc("course/{course-id}/calendar/add", "post", "Add a new event to the calendar object of the course with given course-id, only if the currently logged-in user is an instructor for the course.", ""),
        new Doc("course/{course-id}/calendar/{event-id}/", "get", "View the details of an event given an event-id only if the calendar of the course specified by course-id is the owner of the event, and the currently logged-in user is enrolled in the course.", ""),
        new Doc("course/{course-id}/calendar/{event-id}/update/", "put", "Update an already existing event in the calendar object of the course with the given calendar-id, only if the currently logged-in user is an instructor for the course and created the event.", ""),

        new Doc("user/{user-id}/calendar/" ,"get", "Get the calendar object of the currently logged-in user." ,""),
        new Doc("user/{user-id}/calendar/add", "post", "Add a new event to the personal calendar of the currently logged in user.", ""),
        new Doc("user/{user-id}/calendar/{event-id}/", "get", "View the details of an event given an event-id only if the event belongs to the calendar of the currently logged in user", ""),
        new Doc("user/{user-id}/calendar/{event-id}/update/", "put", "Update an already existing event given the event-id only if the event belongs to the personal calendar of the currently logged-in user.", ""),

      ];
      addDoc(userLoginDocs, "#user-table");
      addDoc(userDocs, "#user-table", "user/");
      addDoc(schoolDocs, "#school-table", "school/");
      addDoc(courseDocs, "#school-table", "course/");


      addDoc(calendarDocs, "#scheduler-table")


    </script>
  </body>
</html>
